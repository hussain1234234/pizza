-- FLY SCRIPT BY RGEENEUS

-- The following code should be in a local script.
-- Only works on PC, not xbox or mobile. I do not have devices to test on.
-- Call the start fly function AFTER the character exists to fly. The function does not run if there is no character. 

    local speed = 50 -- This is the fly speed. Change it to whatever you like. The variable can be changed while running

    local c
    local h
    local bv
    local bav
    local cam
    local flying
    local p = game.Players.LocalPlayer
    local buttons = {W = false, S = false, A = false, D = false, Moving = false}
    
    local sFLY = function () -- Call this function to begin flying 
        if not p.Character or not p.Character.Head or flying then return end
        c = p.Character
        h = c.Humanoid
        h.PlatformStand = true
        cam = workspace:WaitForChild('Camera')
        bv = Instance.new("BodyVelocity")
        bav = Instance.new("BodyAngularVelocity")
        bv.Velocity, bv.MaxForce, bv.P = Vector3.new(0, 0, 0), Vector3.new(10000, 10000, 10000), 1000
        bav.AngularVelocity, bav.MaxTorque, bav.P = Vector3.new(0, 0, 0), Vector3.new(10000, 10000, 10000), 1000
        bv.Parent = c.Head
        bav.Parent = c.Head
        flying = true
        h.Died:connect(function() flying = false end)
    end
    
    local endFly = function () -- Call this function to stop flying
        if not p.Character or not flying then return end
        h.PlatformStand = false
        bv:Destroy()
        bav:Destroy()
        flying = false
    end
    
    game:GetService("UserInputService").InputBegan:connect(function (input, GPE) 
        if GPE then return end
        for i, e in pairs(buttons) do
            if i ~= "Moving" and input.KeyCode == Enum.KeyCode[i] then
                buttons[i] = true
                buttons.Moving = true
            end
        end
    end)
    
    game:GetService("UserInputService").InputEnded:connect(function (input, GPE) 
        if GPE then return end
        local a = false
        for i, e in pairs(buttons) do
            if i ~= "Moving" then
                if input.KeyCode == Enum.KeyCode[i] then
                    buttons[i] = false
                end
                if buttons[i] then a = true end
            end
        end
        buttons.Moving = a
    end)
    
    local setVec = function (vec)
        return vec * (speed / vec.Magnitude)
    end
    
    game:GetService("RunService").Heartbeat:connect(function (step) -- The actual fly function, called every frame
        if flying and c and c.PrimaryPart then
            local p = c.PrimaryPart.Position
            local cf = cam.CFrame
            local ax, ay, az = cf:toEulerAnglesXYZ()
            c:SetPrimaryPartCFrame(CFrame.new(p.x, p.y, p.z) * CFrame.Angles(ax, ay, az))
            if buttons.Moving then
                local t = Vector3.new()
                if buttons.W then t = t + (setVec(cf.lookVector)) end
                if buttons.S then t = t - (setVec(cf.lookVector)) end
                if buttons.A then t = t - (setVec(cf.rightVector)) end
                if buttons.D then t = t + (setVec(cf.rightVector)) end
                c:TranslateBy(t * step)
            end
        end
    end)
function kickk(kicked)
    --check if player have sword
    local yaa, loo = pcall(function()
        local BackPack = game:GetService("Players").LocalPlayer.Backpack["Linked Sword"]
    end)
    if yaa then
    Target = kicked
    local done, fall = pcall(function()
    if game.Players[Target] then
    if game.Players[Target].Character.Humanoid.Sit  then
    game.StarterGui:SetCore("SendNotification", {
    Title = 'Error';
    Text = 'Player Is Sitting';
    Duration = 5;
  })
    else
    sFLY()
    local success, errormessage = pcall(function()
    for _,P in next, game:GetService("Workspace").KrustyKrab:GetChildren() do
    P:Destroy()
    end
	game:GetService("TeleportService"):Teleport(10072127013,plr)
    end)
    game.Players.LocalPlayer.Character["RightUpperLeg"]:Destroy()
    game.Players.LocalPlayer.Character["LeftUpperLeg"]:Destroy()
    local plr = game.Players.LocalPlayer.Character.HumanoidRootPart
    plr.CFrame = CFrame.new(-500.241, -26.85, -543.175)
    NOW = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
    game.Players.LocalPlayer.Character.Humanoid.Name = 1
    local l = game.Players.LocalPlayer.Character["1"]:Clone()
    l.Parent = game.Players.LocalPlayer.Character
    l.Name = "Humanoid"
    wait()
    game.Players.LocalPlayer.Character["1"]:Destroy()
    game.Workspace.CurrentCamera.CameraSubject = game.Players.LocalPlayer.Character
    game.Players.LocalPlayer.Character.Animate.Disabled = true
    wait()
    game.Players.LocalPlayer.Character.Animate.Disabled = false
    game.Players.LocalPlayer.Character.Humanoid.DisplayDistanceType = "None"
    for i,v in pairs(game:GetService'Players'.LocalPlayer.Backpack:GetChildren())do
    game.Players.LocalPlayer.Character.Humanoid:EquipTool(v)
    end
    local function tp(player,player2)
    local char1,char2=player.Character,player2.Character
    if char1 and char2 then
    char1.HumanoidRootPart.CFrame = char2.HumanoidRootPart.CFrame
    end
    end
    local function getout(player,player2)
    local char1,char2=player.Character,player2.Character
    if char1 and char2 then
    char1:MoveTo(char2.Head.Position)
    end
    end
    tp(game.Players[Target], game.Players.LocalPlayer)
    wait()
    tp(game.Players[Target], game.Players.LocalPlayer)
    wait()
    getout(game.Players.LocalPlayer, game.Players[Target])
    wait()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = NOW
    task.wait(2)
    game.Players.LocalPlayer.Character["RightLowerArm"]:Destroy()
    game.Players.LocalPlayer.Character["RightUpperArm"]:Destroy()
    wait(0.1)
    game.Players.LocalPlayer.Character["UpperTorso"]:Destroy()
       end
    end
end)
    if fall then
    workspace.MessageService.Dialog.Dialog:Fire("Warning","Player Not Exist","Ok","",true,true)
    end
    elseif loo then
        workspace.MessageService.Dialog.Dialog:Fire("Warning","You Need Linked Sword To Continue","Ok","",true,true)
    end
end
